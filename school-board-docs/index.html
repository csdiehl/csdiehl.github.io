<!DOCTYPE html><html lang="en" class="antialiased break-words"> <head><!-- Google tag (gtag.js) --><script type="text/partytown" async src="https://www.googletagmanager.com/gtag/js?id=G-NMTRKRDQZV"></script><script type="text/partytown">
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-NMTRKRDQZV');
        </script><!-- High Priority Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Caleb Diehl</title><meta name="generator" content="Astro v4.3.5"><!-- Fonts --><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400..700&family=Newsreader:ital,opsz,wght@0,6..72,400..700;1,6..72,400..700&display=swap" rel="stylesheet"><!-- Low Priority Global Metadata --><link rel="icon" type="image/svg+xml" href="/favicon.svg"><link rel="sitemap" href="/sitemap-index.xml"><link rel="alternate" type="application/rss+xml" href="/rss.xml" title="RSS"><!-- Page Metadata --><link rel="canonical" href="https://csdiehl.github.io/school-board-docs/"><meta name="description" content="The portfolio and blog of Caleb Diehl"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://csdiehl.github.io/school-board-docs/"><meta property="og:title" content="Caleb Diehl"><meta property="og:description" content="The portfolio and blog of Caleb Diehl"><meta property="og:image" content="https://csdiehl.github.io/profile_transparent.jpg"><meta property="og:image:alt" content="Caleb Diehl portfolio and blog"><!-- X/Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://csdiehl.github.io/school-board-docs/"><meta property="twitter:title" content="Caleb Diehl"><meta property="twitter:description" content="The portfolio and blog of Caleb Diehl"><meta property="twitter:image" content="https://csdiehl.github.io/profile_transparent.jpg"><meta name="twitter:image:alt" content="Caleb Diehl portfolio and blog"><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><style>h1[data-astro-cid-u23gns6n],h3[data-astro-cid-u23gns6n],p[data-astro-cid-u23gns6n],.rule[data-astro-cid-u23gns6n]{max-width:660px;margin-left:auto;margin-right:auto}.tech[data-astro-cid-u23gns6n]{font-size:1rem;line-height:1rem;color:#676767;margin:24px auto}main[data-astro-cid-u23gns6n]{margin:0;padding:0}p[data-astro-cid-u23gns6n]{margin-top:8px;margin-bottom:8px}h1[data-astro-cid-u23gns6n]{text-wrap:balance}h3[data-astro-cid-u23gns6n]{margin-top:48px}img[data-astro-cid-u23gns6n]{max-width:1200px;width:100%;border-radius:8px;margin:16px auto}.small[data-astro-cid-u23gns6n]{max-width:660px}.rule[data-astro-cid-u23gns6n]{background-color:#37aecc;height:2px}a[data-astro-cid-u23gns6n]{display:flex;align-items:center;justify-content:center;margin:48px auto;padding:16px;background-color:#37aecc;border-radius:8px;max-width:-moz-max-content;max-width:max-content;color:#fff;font-weight:700}a[data-astro-cid-u23gns6n]:hover{filter:brightness(80%)}
</style>
<link rel="stylesheet" href="/astro/_slug_.SkbYneH3.css" /><script type="module" src="/astro/hoisted.IJOW2Jjz.js"></script>
<script>!(function(w,p,f,c){if(!window.crossOriginIsolated && !navigator.serviceWorker) return;c=w[p]=Object.assign(w[p]||{},{"lib":"/~partytown/","debug":false});c[f]=(c[f]||[]).concat(["dataLayer.push"])})(window,'partytown','forward');/* Partytown 0.8.2 - MIT builder.io */
!function(t,e,n,i,o,r,a,s,d,c,l,p){function u(){p||(p=1,"/"==(a=(r.lib||"/~partytown/")+(r.debug?"debug/":""))[0]&&(d=e.querySelectorAll('script[type="text/partytown"]'),i!=t?i.dispatchEvent(new CustomEvent("pt1",{detail:t})):(s=setTimeout(f,1e4),e.addEventListener("pt0",w),o?h(1):n.serviceWorker?n.serviceWorker.register(a+(r.swPath||"partytown-sw.js"),{scope:a}).then((function(t){t.active?h():t.installing&&t.installing.addEventListener("statechange",(function(t){"activated"==t.target.state&&h()}))}),console.error):f())))}function h(t){c=e.createElement(t?"script":"iframe"),t||(c.style.display="block",c.style.width="0",c.style.height="0",c.style.border="0",c.style.visibility="hidden",c.setAttribute("aria-hidden",!0)),c.src=a+"partytown-"+(t?"atomics.js?v=0.8.2":"sandbox-sw.html?"+Date.now()),e.querySelector(r.sandboxParent||"body").appendChild(c)}function f(n,o){for(w(),i==t&&(r.forward||[]).map((function(e){delete t[e.split(".")[0]]})),n=0;n<d.length;n++)(o=e.createElement("script")).innerHTML=d[n].innerHTML,o.nonce=r.nonce,e.head.appendChild(o);c&&c.parentNode.removeChild(c)}function w(){clearTimeout(s)}r=t.partytown||{},i==t&&(r.forward||[]).map((function(e){l=t,e.split(".").map((function(e,n,i){l=l[i[n]]=n+1<i.length?"push"==i[n+1]?[]:l[i[n]]||{}:function(){(t._ptf=t._ptf||[]).push(i,arguments)}}))})),"complete"==e.readyState?u():(t.addEventListener("DOMContentLoaded",u),t.addEventListener("load",u))}(window,document,navigator,top,window.crossOriginIsolated);;((d,s)=>(s=d.currentScript,d.addEventListener('astro:before-swap',()=>s.remove(),{once:true})))(document);</script></head> <body class="bg-main text-main"> <div class="flex flex-col min-h-screen px-4 md:px-4"> <nav class="py-4 sticky top-0 bg-[#F2F1EB] flex items-start z-10" data-astro-cid-dmqpwcec> <div class="w-full max-w-3xl mx-6 relative" data-astro-cid-dmqpwcec> <button class="menu-toggle w-8 h-8 -ml-1 flex items-center justify-center relative z-30 md:hidden" aria-label="Open Menu" aria-expanded="false" aria-controls="menu-items" data-astro-cid-dmqpwcec> <span class="menu-toggle-icon w-6 h-px relative bg-current" data-astro-cid-dmqpwcec></span> </button> <ul id="menu-items" class="menu flex gap-6" data-astro-cid-dmqpwcec> <li class="py-1" data-astro-cid-dmqpwcec> <a class="text-xl hover:underline hover:underline-offset-2 hover:decoration-1 md:text-2xl md:font-semibold md:text-gray-600" href="/" data-astro-cid-dmqpwcec> Projects </a> </li><li class="py-1" data-astro-cid-dmqpwcec> <a class="text-xl hover:underline hover:underline-offset-2 hover:decoration-1 md:text-2xl md:font-semibold md:text-gray-600" href="/about" data-astro-cid-dmqpwcec> About </a> </li><li class="py-1" data-astro-cid-dmqpwcec> <a class="text-xl hover:underline hover:underline-offset-2 hover:decoration-1 md:text-2xl md:font-semibold md:text-gray-600" href="/blog" data-astro-cid-dmqpwcec> Blog </a> </li> </ul> </div> <div class="absolute right-0 top-4 z-10 md:top-8" data-astro-cid-dmqpwcec>  </div> </nav>   <main class="grow w-full mx-auto ">  <h1 data-astro-cid-u23gns6n>AI-driven school board documents search engine</h1> <div class="rule" data-astro-cid-u23gns6n></div> <p data-astro-cid-u23gns6n>A tool to help journalists search through hundreds of thousands of documents to find key issues in education.</p> <p class="tech" data-astro-cid-u23gns6n><strong data-astro-cid-u23gns6n>Technologies</strong> | PostgreSQL, NextJS, Vercel AI SDK, AWS, Serverless stack</p> <a href="https://d29ogm19i6xujm.cloudfront.net/" data-astro-cid-u23gns6n>View Project</a> <img src="/school-board/main.png" data-astro-cid-u23gns6n> <h3 data-astro-cid-u23gns6n>The problem</h3> <div class="rule" data-astro-cid-u23gns6n></div> <p data-astro-cid-u23gns6n>School board meeting agendas, district planning documents, and meeting transcripts reveal the most pressing issues for parents and students.
    An AP data journalist on the education team built a tool to scrape thousands of school board documents each month.
    They needed a developer to build a database and web app to help reporters search the documents and uncover trends.
    AP recently entered into a partnership with Open AI, so we were interested in exploring solutions that leveraged generative AI.
</p> <img class="small" src="/school-board/example_doc.png" data-astro-cid-u23gns6n> <h3 data-astro-cid-u23gns6n>System Architecture and Design Approach</h3> <div class="rule" data-astro-cid-u23gns6n></div> <p data-astro-cid-u23gns6n>I was the only engineer working on this project, and needed to work within the budget of a nonprofit and time constraints of an active newsroom.
    AP uses AWS for cloud infrastructure, so I set up a postgreSQL database instance to store documents. 
    I developed a NextJS web app, which allowed me to easily organize frontend and backend code and deploy to a serverless stack using SST.
    I set up automated deployments to continously update the app's lamba functions and static assets on S3 while keeping it functional for reporters.
</p> <h3 data-astro-cid-u23gns6n>Challenge: Keyword vs. Vector Search</h3> <div class="rule" data-astro-cid-u23gns6n></div> <p data-astro-cid-u23gns6n>
A signficant consideration that I explored early on was the decision to use keyword search or vector search. 
Vector search offered the potential to type in questions and return context-sensitive results. 
However, it incurred large costs for storing vectors and embedding documents via the OpenAI API. 
I explored an alternative - using AI to generate keywords from an open-ended question and pass those into a Postgres full-text search.
</p> <img class="small" src="/school-board/search_page.png" data-astro-cid-u23gns6n> <p data-astro-cid-u23gns6n>
For this project, scale was a key consideration. We were scraping hundreds of thousands of documents, with plenty added each month. 
On the other hand, the app would have few monthly users as it was intended for journalists and small newsrooms, not the public at large. 
This meant that we needed to optimize for document storage, and could handle the tradeoff of more OpenAI calls for keyword-search queries in exchange for not having to use the embeddings API.
</p> <h3 data-astro-cid-u23gns6n>Challenge: Summarizing large documents</h3> <div class="rule" data-astro-cid-u23gns6n></div> <p data-astro-cid-u23gns6n>Many documents contained tens of pages of meeting information, which quickly exceeded the LLM's context window. 
To solve this problem, I implemented the map-reduce pattern. I first mapped large documents into smaller chunks, then made an API call to summarize each chunk.
Then a final prompt instructed the AI to summarize all of the summaries. </p> <img class="small" src="/school-board/ai_summary.png" data-astro-cid-u23gns6n> <h3 data-astro-cid-u23gns6n>Challenge: transferring large amounts of text data</h3> <div class="rule" data-astro-cid-u23gns6n></div> <p data-astro-cid-u23gns6n>Transferring the entire meeting text of a document over the network proved much too slow. 
To solve this, I paginated results, while making a separate query to return the count of results and other aggregated data for a map visualization. 
I also used Postgres ts_headline to return relevant snippets instead of the entire document, including links to PDF and HTML files stored in S3.
</p> <h3 data-astro-cid-u23gns6n>Results</h3> <p data-astro-cid-u23gns6n>This is an ongoing effort. So far, nearly 45,000 documents are searchable. The education team uses the tool to find trends and publish stories on top issues.</p>  </main> <footer class="w-full max-w-3xl mx-auto pt-12 pb-10 sm:pt-24 sm:pb-14"> <div class="mb-4 flex flex-wrap gap-x-6 gap-y-1"> <a class="font-serif hover:underline hover:underline-offset-2" href="/about"> About </a><a class="font-serif hover:underline hover:underline-offset-2" href="/contact"> Contact </a> </div> <div class="pt-6 flex flex-col gap-4 border-t border-dashed border-main sm:flex-row-reverse sm:justify-between sm:items-center"> <div class="flex flex-wrap gap-x-4 gap-y-1"> <a class="inline-flex items-center justify-center text-sm hover:underline hover:underline-offset-2" href="https://dribbble.com/" target="_blank" rel="noopener noreferer"> Linkedin </a><a class="inline-flex items-center justify-center text-sm hover:underline hover:underline-offset-2" href="https://instagram.com/" target="_blank" rel="noopener noreferer"> Github </a> </div> <p class="text-sm">
&copy; 2024&nbsp;<a class="hover:underline hover:underline-offset-2" href="/">Caleb Diehl</a>. All rights reserved.
</p> </div> </footer> </div> </body></html> 